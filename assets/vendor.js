import{R as n,C as bt,t as he,d as Ct,u as xt,i as St,e as $t,f as vt,g as Et,h as wt,j as v,U as je,_ as W,m as Q,F as Rt,P as Nt,k as Tt,l as It,n as Lt,B as ae,o as Mt,p as Pt,q as Ht,s as ie,T as K,v as be,w as le,r as f,x as Dt,y as Bt,z as J,A as At,D as Ce,E as Xt,G as zt,K as ke,H as Ft,J as _t,L as Wt}from"./antd.js";import{R as Ve,a as qt,b as Ut,c as Ot,d as jt,e as kt,f as Vt,g as Gt,h as Kt,i as Yt,j as Zt,k as Jt}from"./antd-icons.js";const Qt="1.6.0",en=n.createContext({}),tn={classNames:{},styles:{},className:"",style:{}},ee=e=>{const t=n.useContext(en);return n.useMemo(()=>({...tn,...t[e]}),[t[e]])};function k(){const{getPrefixCls:e,direction:t,csp:o,iconPrefixCls:r,theme:s}=n.useContext(bt.ConfigContext);return{theme:s,getPrefixCls:e,direction:t,csp:o,iconPrefixCls:r}}const nn=Ct(he.defaultAlgorithm),rn={screenXS:!0,screenXSMin:!0,screenXSMax:!0,screenSM:!0,screenSMMin:!0,screenSMMax:!0,screenMD:!0,screenMDMin:!0,screenMDMax:!0,screenLG:!0,screenLGMin:!0,screenLGMax:!0,screenXL:!0,screenXLMin:!0,screenXLMax:!0,screenXXL:!0,screenXXLMin:!0},Ge=(e,t,o)=>{const r=o.getDerivativeToken(e),{override:s,...a}=t;let i={...r,override:s};return i=vt(i),a&&Object.entries(a).forEach(([l,c])=>{const{theme:d,...u}=c;let b=u;d&&(b=Ge({...i,...u},{override:u},d)),i[l]=b}),i};function on(){const{token:e,hashed:t,theme:o=nn,override:r,cssVar:s}=n.useContext(he._internalContext),[a,i,l]=xt(o,[he.defaultSeed,e],{salt:`${Qt}-${t||""}`,override:r,getComputedToken:Ge,cssVar:s&&{prefix:s.prefix,key:s.key,unitless:$t,ignore:St,preserve:rn}});return[o,l,t?i:"",a,s]}const{genStyleHooks:te}=Et({usePrefix:()=>{const{getPrefixCls:e,iconPrefixCls:t}=k();return{iconPrefixCls:t,rootPrefixCls:e()}},useToken:()=>{const[e,t,o,r,s]=on();return{theme:e,realToken:t,hashId:o,token:r,cssVar:s}},useCSP:()=>{const{csp:e}=k();return e??{}},layer:{name:"antdx",dependencies:["antd"]}}),ce=n.createContext(null);function Me(e){const{getDropContainer:t,className:o,prefixCls:r,children:s}=e,{disabled:a}=n.useContext(ce),[i,l]=n.useState(),[c,d]=n.useState(null);if(n.useEffect(()=>{const y=t?.();i!==y&&l(y)},[t]),n.useEffect(()=>{if(i){const y=()=>{d(!0)},S=g=>{g.preventDefault()},w=g=>{g.relatedTarget||d(!1)},m=g=>{d(!1),g.preventDefault()};return document.addEventListener("dragenter",y),document.addEventListener("dragover",S),document.addEventListener("dragleave",w),document.addEventListener("drop",m),()=>{document.removeEventListener("dragenter",y),document.removeEventListener("dragover",S),document.removeEventListener("dragleave",w),document.removeEventListener("drop",m)}}},[!!i]),!(t&&i&&!a))return null;const b=`${r}-drop-area`;return wt.createPortal(n.createElement("div",{className:v(b,o,{[`${b}-on-body`]:i.tagName==="BODY"}),style:{display:c?"block":"none"}},s),i)}function sn(e,t){const{children:o,upload:r,rootClassName:s}=e,a=n.useRef(null);return n.useImperativeHandle(t,()=>a.current),n.createElement(je,W({},r,{showUploadList:!1,rootClassName:s,ref:a}),o)}const Ke=n.forwardRef(sn),an=e=>{const{componentCls:t,antCls:o,calc:r}=e,s=`${t}-list-card`,a=r(e.fontSize).mul(e.lineHeight).mul(2).add(e.paddingSM).add(e.paddingSM).equal();return{[s]:{borderRadius:e.borderRadius,position:"relative",background:e.colorFillContent,borderWidth:e.lineWidth,borderStyle:"solid",borderColor:"transparent",flex:"none",[`${s}-name,${s}-desc`]:{display:"flex",flexWrap:"nowrap",maxWidth:"100%"},[`${s}-ellipsis-prefix`]:{flex:"0 1 auto",minWidth:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},[`${s}-ellipsis-suffix`]:{flex:"none"},"&-type-overview":{padding:r(e.paddingSM).sub(e.lineWidth).equal(),paddingInlineStart:r(e.padding).add(e.lineWidth).equal(),display:"flex",flexWrap:"nowrap",gap:e.paddingXS,alignItems:"flex-start",width:236,[`${s}-icon`]:{fontSize:r(e.fontSizeLG).mul(2).equal(),lineHeight:1,paddingTop:r(e.paddingXXS).mul(1.5).equal(),flex:"none"},[`${s}-content`]:{flex:"auto",minWidth:0,display:"flex",flexDirection:"column",alignItems:"stretch"},[`${s}-desc`]:{color:e.colorTextTertiary}},"&-type-preview":{width:a,height:a,lineHeight:1,display:"flex",alignItems:"center",[`&:not(${s}-status-error)`]:{border:0},[`${o}-image`]:{width:"100%",height:"100%",borderRadius:"inherit",position:"relative",overflow:"hidden",img:{height:"100%",objectFit:"cover",borderRadius:"inherit"}},[`${s}-img-mask`]:{position:"absolute",inset:0,display:"flex",justifyContent:"center",alignItems:"center",borderRadius:"inherit",background:`rgba(0, 0, 0, ${e.opacityLoading})`},[`&${s}-status-error`]:{borderRadius:"inherit",[`img, ${s}-img-mask`]:{borderRadius:r(e.borderRadius).sub(e.lineWidth).equal()},[`${s}-desc`]:{paddingInline:e.paddingXXS}},[`${s}-progress`]:{}},[`${s}-remove`]:{position:"absolute",top:0,insetInlineEnd:0,border:0,padding:e.paddingXXS,background:"transparent",lineHeight:1,transform:"translate(50%, -50%)",fontSize:e.fontSize,cursor:"pointer",opacity:e.opacityLoading,display:"none","&:dir(rtl)":{transform:"translate(-50%, -50%)"},"&:hover":{opacity:1},"&:active":{opacity:e.opacityLoading}},[`&:hover ${s}-remove`]:{display:"block"},"&-status-error":{borderColor:e.colorError,[`${s}-desc`]:{color:e.colorError}},"&-motion":{transition:["opacity","width","margin","padding"].map(i=>`${i} ${e.motionDurationSlow}`).join(","),"&-appear-start":{width:0,transition:"none"},"&-leave-active":{opacity:0,width:0,paddingInline:0,borderInlineWidth:0,marginInlineEnd:r(e.paddingSM).mul(-1).equal()}}}}},Re={"&, *":{boxSizing:"border-box"}},ln=e=>{const{componentCls:t,calc:o,antCls:r}=e,s=`${t}-drop-area`,a=`${t}-placeholder`;return{[s]:{position:"absolute",inset:0,zIndex:e.zIndexPopupBase,...Re,"&-on-body":{position:"fixed",inset:0},"&-hide-placement":{[`${a}-inner`]:{display:"none"}},[a]:{padding:0}},"&":{[a]:{height:"100%",borderRadius:e.borderRadius,borderWidth:e.lineWidthBold,borderStyle:"dashed",borderColor:"transparent",padding:e.padding,position:"relative",backdropFilter:"blur(10px)",background:e.colorBgPlaceholderHover,...Re,[`${r}-upload-wrapper ${r}-upload${r}-upload-btn`]:{padding:0},[`&${a}-drag-in`]:{borderColor:e.colorPrimaryHover},[`&${a}-disabled`]:{opacity:.25,pointerEvents:"none"},[`${a}-inner`]:{gap:o(e.paddingXXS).div(2).equal()},[`${a}-icon`]:{fontSize:e.fontSizeHeading2,lineHeight:1},[`${a}-title${a}-title`]:{margin:0,fontSize:e.fontSize,lineHeight:e.lineHeight},[`${a}-description`]:{}}}}},cn=e=>{const{componentCls:t,calc:o}=e,r=`${t}-list`,s=o(e.fontSize).mul(e.lineHeight).mul(2).add(e.paddingSM).add(e.paddingSM).equal();return{[t]:{position:"relative",width:"100%",...Re,[r]:{display:"flex",flexWrap:"wrap",gap:e.paddingSM,fontSize:e.fontSize,lineHeight:e.lineHeight,color:e.colorText,paddingBlock:e.paddingSM,paddingInline:e.padding,width:"100%",background:e.colorBgContainer,scrollbarWidth:"none","-ms-overflow-style":"none","&::-webkit-scrollbar":{display:"none"},"&-overflow-scrollX, &-overflow-scrollY":{"&:before, &:after":{content:'""',position:"absolute",opacity:0,transition:`opacity ${e.motionDurationSlow}`,zIndex:1}},"&-overflow-ping-start:before":{opacity:1},"&-overflow-ping-end:after":{opacity:1},"&-overflow-scrollX":{overflowX:"auto",overflowY:"hidden",flexWrap:"nowrap","&:before, &:after":{insetBlock:0,width:8},"&:before":{insetInlineStart:0,background:"linear-gradient(to right, rgba(0,0,0,0.06), rgba(0,0,0,0));"},"&:after":{insetInlineEnd:0,background:"linear-gradient(to left, rgba(0,0,0,0.06), rgba(0,0,0,0));"},"&:dir(rtl)":{"&:before":{background:"linear-gradient(to left, rgba(0,0,0,0.06), rgba(0,0,0,0));"},"&:after":{background:"linear-gradient(to right, rgba(0,0,0,0.06), rgba(0,0,0,0));"}}},"&-overflow-scrollY":{overflowX:"hidden",overflowY:"auto",maxHeight:o(s).mul(3).equal(),"&:before, &:after":{insetInline:0,height:8},"&:before":{insetBlockStart:0,background:"linear-gradient(to bottom, rgba(0,0,0,0.06), rgba(0,0,0,0));"},"&:after":{insetBlockEnd:0,background:"linear-gradient(to top, rgba(0,0,0,0.06), rgba(0,0,0,0));"}},"&-upload-btn":{width:s,height:s,fontSize:e.fontSizeHeading2,color:"#999"},"&-prev-btn, &-next-btn":{position:"absolute",top:"50%",transform:"translateY(-50%)",boxShadow:e.boxShadowTertiary,opacity:0,pointerEvents:"none"},"&-prev-btn":{left:{_skip_check_:!0,value:e.padding}},"&-next-btn":{right:{_skip_check_:!0,value:e.padding}},"&:dir(ltr)":{[`&${r}-overflow-ping-start ${r}-prev-btn`]:{opacity:1,pointerEvents:"auto"},[`&${r}-overflow-ping-end ${r}-next-btn`]:{opacity:1,pointerEvents:"auto"}},"&:dir(rtl)":{[`&${r}-overflow-ping-end ${r}-prev-btn`]:{opacity:1,pointerEvents:"auto"},[`&${r}-overflow-ping-start ${r}-next-btn`]:{opacity:1,pointerEvents:"auto"}}}}}},dn=e=>{const{colorBgContainer:t}=e;return{colorBgPlaceholderHover:new Rt(t).setA(.85).toRgbString()}},Ye=te("Attachments",e=>{const t=Q(e,{});return[ln(t),cn(t),an(t)]},dn),un=e=>e.indexOf("image/")===0,de=200;function mn(e){return new Promise(t=>{if(!e||!e.type||!un(e.type)){t("");return}const o=new Image;if(o.onload=()=>{const{width:r,height:s}=o,a=r/s,i=a>1?de:de*a,l=a>1?de/a:de,c=document.createElement("canvas");c.width=i,c.height=l,c.style.cssText=`position: fixed; left: 0; top: 0; width: ${i}px; height: ${l}px; z-index: 9999; display: none;`,document.body.appendChild(c),c.getContext("2d").drawImage(o,0,0,i,l);const u=c.toDataURL();document.body.removeChild(c),window.URL.revokeObjectURL(o.src),t(u)},o.crossOrigin="anonymous",e.type.startsWith("image/svg+xml")){const r=new FileReader;r.onload=()=>{r.result&&typeof r.result=="string"&&(o.src=r.result)},r.readAsDataURL(e)}else if(e.type.startsWith("image/gif")){const r=new FileReader;r.onload=()=>{r.result&&t(r.result)},r.readAsDataURL(e)}else o.src=window.URL.createObjectURL(e)})}function pn(){return n.createElement("svg",{width:"1em",height:"1em",viewBox:"0 0 16 16",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},n.createElement("title",null,"audio"),n.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},n.createElement("path",{d:"M14.1178571,4.0125 C14.225,4.11964286 14.2857143,4.26428571 14.2857143,4.41607143 L14.2857143,15.4285714 C14.2857143,15.7446429 14.0303571,16 13.7142857,16 L2.28571429,16 C1.96964286,16 1.71428571,15.7446429 1.71428571,15.4285714 L1.71428571,0.571428571 C1.71428571,0.255357143 1.96964286,0 2.28571429,0 L9.86964286,0 C10.0214286,0 10.1678571,0.0607142857 10.275,0.167857143 L14.1178571,4.0125 Z M10.7315824,7.11216117 C10.7428131,7.15148751 10.7485063,7.19218979 10.7485063,7.23309113 L10.7485063,8.07742614 C10.7484199,8.27364959 10.6183424,8.44607275 10.4296853,8.50003683 L8.32984514,9.09986306 L8.32984514,11.7071803 C8.32986605,12.5367078 7.67249692,13.217028 6.84345686,13.2454634 L6.79068592,13.2463395 C6.12766108,13.2463395 5.53916361,12.8217001 5.33010655,12.1924966 C5.1210495,11.563293 5.33842118,10.8709227 5.86959669,10.4741173 C6.40077221,10.0773119 7.12636292,10.0652587 7.67042486,10.4442027 L7.67020842,7.74937024 L7.68449368,7.74937024 C7.72405122,7.59919041 7.83988806,7.48101083 7.98924584,7.4384546 L10.1880418,6.81004755 C10.42156,6.74340323 10.6648954,6.87865515 10.7315824,7.11216117 Z M9.60714286,1.31785714 L12.9678571,4.67857143 L9.60714286,4.67857143 L9.60714286,1.31785714 Z",fill:"currentColor"})))}function fn(e){const{percent:t}=e,{token:o}=he.useToken();return n.createElement(Nt,{type:"circle",percent:t,size:o.fontSizeHeading2*2,strokeColor:"#FFF",trailColor:"rgba(255, 255, 255, 0.3)",format:r=>n.createElement("span",{style:{color:"#FFF"}},(r||0).toFixed(0),"%")})}function gn(){return n.createElement("svg",{width:"1em",height:"1em",viewBox:"0 0 16 16",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},n.createElement("title",null,"video"),n.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},n.createElement("path",{d:"M14.1178571,4.0125 C14.225,4.11964286 14.2857143,4.26428571 14.2857143,4.41607143 L14.2857143,15.4285714 C14.2857143,15.7446429 14.0303571,16 13.7142857,16 L2.28571429,16 C1.96964286,16 1.71428571,15.7446429 1.71428571,15.4285714 L1.71428571,0.571428571 C1.71428571,0.255357143 1.96964286,0 2.28571429,0 L9.86964286,0 C10.0214286,0 10.1678571,0.0607142857 10.275,0.167857143 L14.1178571,4.0125 Z M12.9678571,4.67857143 L9.60714286,1.31785714 L9.60714286,4.67857143 L12.9678571,4.67857143 Z M10.5379461,10.3101106 L6.68957555,13.0059749 C6.59910784,13.0693494 6.47439406,13.0473861 6.41101953,12.9569184 C6.3874624,12.9232903 6.37482581,12.8832269 6.37482581,12.8421686 L6.37482581,7.45043999 C6.37482581,7.33998304 6.46436886,7.25043999 6.57482581,7.25043999 C6.61588409,7.25043999 6.65594753,7.26307658 6.68957555,7.28663371 L10.5379461,9.98249803 C10.6284138,10.0458726 10.6503772,10.1705863 10.5870027,10.2610541 C10.5736331,10.2801392 10.5570312,10.2967411 10.5379461,10.3101106 Z",fill:"currentColor"})))}const Ee="Â ",fe="#8c8c8c",Ze=["png","jpg","jpeg","gif","bmp","webp","svg"],Pe=[{key:"default",icon:n.createElement(Ve,null),color:fe,ext:[]},{key:"excel",icon:n.createElement(qt,null),color:"#22b35e",ext:["xlsx","xls"]},{key:"image",icon:n.createElement(Ut,null),color:fe,ext:Ze},{key:"markdown",icon:n.createElement(Ot,null),color:fe,ext:["md","mdx"]},{key:"pdf",icon:n.createElement(jt,null),color:"#ff4d4f",ext:["pdf"]},{key:"ppt",icon:n.createElement(kt,null),color:"#ff6e31",ext:["ppt","pptx"]},{key:"word",icon:n.createElement(Vt,null),color:"#1677ff",ext:["doc","docx"]},{key:"zip",icon:n.createElement(Gt,null),color:"#fab714",ext:["zip","rar","7z","tar","gz"]},{key:"video",icon:n.createElement(gn,null),color:"#ff4d4f",ext:["mp4","avi","mov","wmv","flv","mkv"]},{key:"audio",icon:n.createElement(pn,null),color:"#8c8c8c",ext:["mp3","wav","flac","ape","aac","ogg"]}];function He(e,t){return t.some(o=>e.toLowerCase()===`.${o}`)}function hn(e){let t=e;const o=["B","KB","MB","GB","TB","PB","EB"];let r=0;for(;t>=1024&&r<o.length-1;)t/=1024,r++;return`${t.toFixed(0)} ${o[r]}`}function yn(e,t){const{prefixCls:o,item:r,onRemove:s,className:a,style:i,imageProps:l,type:c,icon:d}=e,u=n.useContext(ce),{disabled:b}=u||{},{name:y,size:S,percent:w,status:m="done",description:g}=r,{getPrefixCls:M}=k(),B=M("attachment",o),h=`${B}-list-card`,[$,x,C]=Ye(B),[I,D]=n.useMemo(()=>{const T=y||"",X=T.match(/^(.*)\.[^.]+$/);return X?[X[1],T.slice(X[1].length)]:[T,""]},[y]),R=n.useMemo(()=>He(D,Ze),[D]),p=n.useMemo(()=>g||(m==="uploading"?`${w||0}%`:m==="error"?r.response||Ee:S?hn(S):Ee),[m,w]),[E,L]=n.useMemo(()=>{if(d)if(typeof d=="string"){const T=Pe.find(X=>X.key===d);if(T)return[T.icon,T.color]}else return[d,void 0];for(const{ext:T,icon:X,color:j}of Pe)if(He(D,T))return[X,j];return[n.createElement(Ve,{key:"defaultIcon"}),fe]},[D,d]),[P,H]=n.useState();n.useEffect(()=>{if(r.originFileObj){let T=!0;return mn(r.originFileObj).then(X=>{T&&H(X)}),()=>{T=!1}}H(void 0)},[r.originFileObj]);let N=null;const A=r.thumbUrl||r.url||P,z=c==="image"||c!=="file"&&R&&(r.originFileObj||A);return z?N=n.createElement(n.Fragment,null,A&&n.createElement(Tt,W({alt:"preview",src:A},l)),m!=="done"&&n.createElement("div",{className:`${h}-img-mask`},m==="uploading"&&w!==void 0&&n.createElement(fn,{percent:w,prefixCls:h}),m==="error"&&n.createElement("div",{className:`${h}-desc`},n.createElement("div",{className:`${h}-ellipsis-prefix`},p)))):N=n.createElement(n.Fragment,null,n.createElement("div",{className:`${h}-icon`,style:L?{color:L}:void 0},E),n.createElement("div",{className:`${h}-content`},n.createElement("div",{className:`${h}-name`},n.createElement("div",{className:`${h}-ellipsis-prefix`},I??Ee),n.createElement("div",{className:`${h}-ellipsis-suffix`},D)),n.createElement("div",{className:`${h}-desc`},n.createElement("div",{className:`${h}-ellipsis-prefix`},p)))),$(n.createElement("div",{className:v(h,{[`${h}-status-${m}`]:m,[`${h}-type-preview`]:z,[`${h}-type-overview`]:!z},a,x,C),style:i,ref:t},N,!b&&s&&n.createElement("button",{type:"button",className:`${h}-remove`,onClick:()=>{s(r)}},n.createElement(It,null))))}const Je=n.forwardRef(yn),De=1;function bn(e){const{prefixCls:t,items:o,onRemove:r,overflow:s,upload:a,listClassName:i,listStyle:l,itemClassName:c,uploadClassName:d,uploadStyle:u,itemStyle:b,imageProps:y}=e,S=`${t}-list`,w=n.useRef(null),[m,g]=n.useState(!1),{disabled:M}=n.useContext(ce);n.useEffect(()=>(g(!0),()=>{g(!1)}),[]);const[B,h]=n.useState(!1),[$,x]=n.useState(!1),C=()=>{const p=w.current;p&&(s==="scrollX"?(h(Math.abs(p.scrollLeft)>=De),x(p.scrollWidth-p.clientWidth-Math.abs(p.scrollLeft)>=De)):s==="scrollY"&&(h(p.scrollTop!==0),x(p.scrollHeight-p.clientHeight!==p.scrollTop)))};n.useEffect(()=>{C()},[s,o.length]);const I=p=>{const E=w.current;E&&E.scrollTo({left:E.scrollLeft+p*E.clientWidth,behavior:"smooth"})},D=()=>{I(-1)},R=()=>{I(1)};return n.createElement("div",{className:v(S,{[`${S}-overflow-${e.overflow}`]:s,[`${S}-overflow-ping-start`]:B,[`${S}-overflow-ping-end`]:$},i),ref:w,onScroll:C,style:l},n.createElement(Lt,{keys:o.map(p=>({key:p.uid,item:p})),motionName:`${S}-card-motion`,component:!1,motionAppear:m,motionLeave:!0,motionEnter:!0},({key:p,item:E,className:L,style:P})=>n.createElement(Je,{key:p,prefixCls:t,item:E,onRemove:r,className:v(L,c),imageProps:y,style:{...P,...b}})),!M&&n.createElement(Ke,{upload:a},n.createElement(ae,{className:v(d,`${S}-upload-btn`),style:u,type:"dashed"},n.createElement(Mt,{className:`${S}-upload-btn-icon`}))),s==="scrollX"&&n.createElement(n.Fragment,null,n.createElement(ae,{size:"small",shape:"circle",className:`${S}-prev-btn`,icon:n.createElement(Pt,null),onClick:D}),n.createElement(ae,{size:"small",shape:"circle",className:`${S}-next-btn`,icon:n.createElement(Ht,null),onClick:R})))}function Cn(e,t){const{prefixCls:o,placeholder:r={},upload:s,className:a,style:i}=e,l=`${o}-placeholder`,c=r||{},{disabled:d}=n.useContext(ce),[u,b]=n.useState(!1),y=()=>{b(!0)},S=g=>{g.currentTarget.contains(g.relatedTarget)||b(!1)},w=()=>{b(!1)},m=n.isValidElement(r)?r:n.createElement(ie,{align:"center",justify:"center",vertical:!0,className:`${l}-inner`},n.createElement(K.Text,{className:`${l}-icon`},c.icon),n.createElement(K.Title,{className:`${l}-title`,level:5},c.title),n.createElement(K.Text,{className:`${l}-description`,type:"secondary"},c.description));return n.createElement("div",{className:v(l,{[`${l}-drag-in`]:u,[`${l}-disabled`]:d},a),onDragEnter:y,onDragLeave:S,onDrop:w,"aria-hidden":d,style:i},n.createElement(je.Dragger,W({showUploadList:!1},s,{ref:t,style:{padding:0,border:0,background:"transparent"}}),m))}const xn=n.forwardRef(Cn);function Sn(e,t){const{prefixCls:o,rootClassName:r,rootStyle:s,className:a,style:i,items:l,children:c,getDropContainer:d,placeholder:u,onChange:b,onRemove:y,overflow:S,imageProps:w,disabled:m,maxCount:g,classNames:M={},styles:B={},...h}=e,{getPrefixCls:$,direction:x}=k(),C=$("attachment",o),I=ee("attachments"),{classNames:D,styles:R}=I,p=n.useRef(null),E=n.useRef(null);n.useImperativeHandle(t,()=>({nativeElement:p.current,upload:_=>{const O=E.current?.nativeElement?.querySelector('input[type="file"]');if(O){const U=new DataTransfer;U.items.add(_),O.files=U.files,O.dispatchEvent(new Event("change",{bubbles:!0}))}}}));const[L,P,H]=Ye(C),N=v(P,H),[A,z]=be([],{value:l}),T=le(_=>{z(_.fileList),b?.(_)}),X={...h,fileList:A,maxCount:g,onChange:T},j=_=>Promise.resolve(typeof y=="function"?y(_):y).then(O=>{if(O===!1)return;const U=A.filter(q=>q.uid!==_.uid);T({file:{..._,status:"removed"},fileList:U})});let V;const Y=(_,O,U)=>{const q=typeof u=="function"?u(_):u;return n.createElement(xn,{placeholder:q,upload:X,prefixCls:C,className:v(D.placeholder,M.placeholder),style:{...R.placeholder,...B.placeholder,...O?.style},ref:U})};if(c)V=n.createElement(n.Fragment,null,n.createElement(Ke,{upload:X,rootClassName:r,ref:E},c),n.createElement(Me,{getDropContainer:d,prefixCls:C,className:v(N,r)},Y("drop")));else{const _=A.length>0;V=n.createElement("div",{className:v(C,N,{[`${C}-rtl`]:x==="rtl"},a,r),style:{...s,...i},dir:x||"ltr",ref:p},n.createElement(bn,{prefixCls:C,items:A,onRemove:j,overflow:S,upload:X,listClassName:v(D.list,M.list),listStyle:{...R.list,...B.list,...!_&&{display:"none"}},uploadClassName:v(D.upload,M.upload),uploadStyle:{...R.upload,...B.upload},itemClassName:v(D.item,M.item),itemStyle:{...R.item,...B.item},imageProps:w}),Y("inline",_?{style:{display:"none"}}:{},E),n.createElement(Me,{getDropContainer:d||(()=>p.current),prefixCls:C,className:N},Y("drop")))}return L(n.createElement(ce.Provider,{value:{disabled:m}},V))}const $n=n.forwardRef(Sn);$n.FileCard=Je;function vn(e,t){return f.useImperativeHandle(e,()=>{const o=t(),{nativeElement:r}=o;return new Proxy(r,{get(s,a){return o[a]?o[a]:Reflect.get(s,a)}})})}const Qe=f.createContext({}),Be=()=>({height:0}),Ae=e=>({height:e.scrollHeight});function En(e){const{title:t,onOpenChange:o,open:r,children:s,className:a,style:i,classNames:l={},styles:c={},closable:d,forceRender:u}=e,{prefixCls:b}=f.useContext(Qe),y=`${b}-header`;return f.createElement(Dt,{motionEnter:!0,motionLeave:!0,motionName:`${y}-motion`,leavedClassName:`${y}-motion-hidden`,onEnterStart:Be,onEnterActive:Ae,onLeaveStart:Ae,onLeaveActive:Be,visible:r,forceRender:u},({className:S,style:w})=>f.createElement("div",{className:v(y,S,a),style:{...w,...i}},(d!==!1||t)&&f.createElement("div",{className:v(`${y}-header`,l.header),style:{...c.header}},f.createElement("div",{className:`${y}-title`},t),d!==!1&&f.createElement("div",{className:`${y}-close`},f.createElement(ae,{type:"text",icon:f.createElement(Bt,null),size:"small",onClick:()=>{o?.(!r)}}))),s&&f.createElement("div",{className:v(`${y}-content`,l.content),style:{...c.content}},s)))}const xe=f.createContext(null);function wn(e,t){const{className:o,action:r,onClick:s,...a}=e,i=f.useContext(xe),{prefixCls:l,disabled:c}=i,d=a.disabled??c??i[`${r}Disabled`];return f.createElement(ae,W({type:"text"},a,{ref:t,onClick:u=>{d||(i[r]?.(),s?.(u))},className:v(l,o,{[`${l}-disabled`]:d})}))}const Se=f.forwardRef(wn);function Rn(e,t){return f.createElement(Se,W({icon:f.createElement(Kt,null)},e,{action:"onClear",ref:t}))}const Nn=f.forwardRef(Rn),Tn=f.memo(e=>{const{className:t}=e;return n.createElement("svg",{color:"currentColor",viewBox:"0 0 1000 1000",xmlns:"http://www.w3.org/2000/svg",className:t},n.createElement("title",null,"Stop Loading"),n.createElement("rect",{fill:"currentColor",height:"250",rx:"24",ry:"24",width:"250",x:"375",y:"375"}),n.createElement("circle",{cx:"500",cy:"500",fill:"none",r:"450",stroke:"currentColor",strokeWidth:"100",opacity:"0.45"}),n.createElement("circle",{cx:"500",cy:"500",fill:"none",r:"450",stroke:"currentColor",strokeWidth:"100",strokeDasharray:"600 9999999"},n.createElement("animateTransform",{attributeName:"transform",dur:"1s",from:"0 500 500",repeatCount:"indefinite",to:"360 500 500",type:"rotate"})))});function In(e,t){const{prefixCls:o}=f.useContext(xe),{className:r}=e;return f.createElement(Se,W({icon:null,color:"primary",variant:"text",shape:"circle"},e,{className:v(r,`${o}-loading-button`),action:"onCancel",ref:t}),f.createElement(Tn,{className:`${o}-loading-icon`}))}const et=f.forwardRef(In);function Ln(e,t){return f.createElement(Se,W({icon:f.createElement(Yt,null),type:"primary",shape:"circle"},e,{action:"onSend",ref:t}))}const tt=f.forwardRef(Ln),oe=1e3,se=4,ge=140,Xe=ge/2,ue=250,ze=500,me=.8;function Mn({className:e}){return n.createElement("svg",{color:"currentColor",viewBox:`0 0 ${oe} ${oe}`,xmlns:"http://www.w3.org/2000/svg",className:e},n.createElement("title",null,"Speech Recording"),Array.from({length:se}).map((t,o)=>{const r=(oe-ge*se)/(se-1),s=o*(r+ge),a=oe/2-ue/2,i=oe/2-ze/2;return n.createElement("rect",{fill:"currentColor",rx:Xe,ry:Xe,height:ue,width:ge,x:s,y:a,key:o},n.createElement("animate",{attributeName:"height",values:`${ue}; ${ze}; ${ue}`,keyTimes:"0; 0.5; 1",dur:`${me}s`,begin:`${me/se*o}s`,repeatCount:"indefinite"}),n.createElement("animate",{attributeName:"y",values:`${a}; ${i}; ${a}`,keyTimes:"0; 0.5; 1",dur:`${me}s`,begin:`${me/se*o}s`,repeatCount:"indefinite"}))}))}function Pn(e,t){const{speechRecording:o,onSpeechDisabled:r,prefixCls:s}=f.useContext(xe);let a=null;return o?a=f.createElement(Mn,{className:`${s}-recording-icon`}):r?a=f.createElement(Zt,null):a=f.createElement(Jt,null),f.createElement(Se,W({icon:a,color:"primary",variant:"text"},e,{action:"onSpeech",ref:t}))}const nt=f.forwardRef(Pn),Hn=e=>{const{componentCls:t,calc:o}=e,r=`${t}-header`;return{[t]:{[r]:{borderBottomWidth:e.lineWidth,borderBottomStyle:"solid",borderBottomColor:e.colorBorder,"&-header":{background:e.colorFillAlter,fontSize:e.fontSize,lineHeight:e.lineHeight,paddingBlock:o(e.paddingSM).sub(e.lineWidthBold).equal(),paddingInlineStart:e.padding,paddingInlineEnd:e.paddingXS,display:"flex",borderRadius:{_skip_check_:!0,value:o(e.borderRadius).mul(2).equal()},borderEndStartRadius:0,borderEndEndRadius:0,[`${r}-title`]:{flex:"auto"}},"&-content":{padding:e.padding},"&-motion":{transition:["height","border"].map(s=>`${s} ${e.motionDurationSlow}`).join(","),overflow:"hidden","&-enter-start, &-leave-active":{borderBottomColor:"transparent"},"&-hidden":{display:"none"}}}}}},Dn=e=>{const{componentCls:t,padding:o,paddingSM:r,paddingXS:s,paddingXXS:a,lineWidth:i,lineWidthBold:l,calc:c}=e;return{[t]:{position:"relative",width:"100%",boxSizing:"border-box",boxShadow:`${e.boxShadowTertiary}`,transition:`background ${e.motionDurationSlow}`,borderRadius:{_skip_check_:!0,value:c(e.borderRadius).mul(2).equal()},borderColor:e.colorBorder,borderWidth:0,borderStyle:"solid","&:after":{content:'""',position:"absolute",inset:0,pointerEvents:"none",transition:`border-color ${e.motionDurationSlow}`,borderRadius:{_skip_check_:!0,value:"inherit"},borderStyle:"inherit",borderColor:"inherit",borderWidth:i},"&:focus-within":{boxShadow:`${e.boxShadowSecondary}`,borderColor:e.colorPrimary,"&:after":{borderWidth:l}},"&-disabled":{background:e.colorBgContainerDisabled},[`&${t}-rtl`]:{direction:"rtl"},[`${t}-content`]:{display:"flex",gap:s,width:"100%",paddingBlock:r,paddingInlineStart:o,paddingInlineEnd:r,boxSizing:"border-box",alignItems:"flex-end"},[`${t}-prefix`]:{flex:"none"},[`${t}-input`]:{padding:0,borderRadius:0,flex:"auto",alignSelf:"center",minHeight:"auto"},[`${t}-actions-list`]:{flex:"none",display:"flex","&-presets":{gap:e.paddingXS}},[`${t}-actions-btn`]:{"&-disabled":{opacity:.45},"&-loading-button":{padding:0,border:0},"&-loading-icon":{height:e.controlHeight,width:e.controlHeight,verticalAlign:"top"},"&-recording-icon":{height:"1.2em",width:"1.2em",verticalAlign:"top"}},[`${t}-footer`]:{paddingInlineStart:o,paddingInlineEnd:r,paddingBlockEnd:r,paddingBlockStart:a,boxSizing:"border-box"}}}},Bn=()=>({}),An=te("Sender",e=>{const{paddingXS:t,calc:o}=e,r=Q(e,{SenderContentMaxWidth:`calc(100% - ${J(o(t).add(32).equal())})`});return[Dn(r),Hn(r)]},Bn);let ye;!ye&&typeof window<"u"&&(ye=window.SpeechRecognition||window.webkitSpeechRecognition);function Xn(e,t){const o=le(e),[r,s,a]=n.useMemo(()=>typeof t=="object"?[t.recording,t.onRecordingChange,typeof t.recording=="boolean"]:[void 0,void 0,!1],[t]),[i,l]=n.useState(null);n.useEffect(()=>{if(typeof navigator<"u"&&"permissions"in navigator){let m=null;return navigator.permissions.query({name:"microphone"}).then(g=>{l(g.state),g.onchange=function(){l(this.state)},m=g}),()=>{m&&(m.onchange=null)}}},[]);const c=ye&&i!=="denied",d=n.useRef(null),[u,b]=be(!1,{value:r}),y=n.useRef(!1),S=()=>{if(c&&!d.current){const m=new ye;m.onstart=()=>{b(!0)},m.onend=()=>{b(!1)},m.onresult=g=>{if(!y.current){const M=g.results?.[0]?.[0]?.transcript;o(M)}y.current=!1},d.current=m}},w=le(m=>{m&&!u||(y.current=m,a?s?.(!u):(S(),d.current&&(u?(d.current.stop(),s?.(!1)):(d.current.start(),s?.(!0)))))});return[c,w,u]}function zn(e,t,o){return Xt(e,t)||o}const Fe={SendButton:tt,ClearButton:Nn,LoadingButton:et,SpeechButton:nt},Fn=n.forwardRef((e,t)=>{const{prefixCls:o,styles:r={},classNames:s={},className:a,rootClassName:i,style:l,defaultValue:c,value:d,readOnly:u,submitType:b="enter",onSubmit:y,loading:S,components:w,onCancel:m,onChange:g,actions:M,onKeyPress:B,onKeyDown:h,disabled:$,allowSpeech:x,prefix:C,footer:I,header:D,onPaste:R,onPasteFile:p,autoSize:E={maxRows:8},...L}=e,{direction:P,getPrefixCls:H}=k(),N=H("sender",o),A=n.useRef(null),z=n.useRef(null);vn(t,()=>({nativeElement:A.current,focus:z.current?.focus,blur:z.current?.blur}));const T=ee("sender"),X=`${N}-input`,[j,V,Y]=An(N),_=v(N,T.className,a,i,V,Y,{[`${N}-rtl`]:P==="rtl",[`${N}-disabled`]:$}),O=`${N}-actions-btn`,U=`${N}-actions-list`,[q,ne]=be(c||"",{value:d}),Z=(F,G)=>{ne(F),g&&g(F,G)},[it,Ie,lt]=Xn(F=>{Z(`${q} ${F}`)},x),ct=zn(w,["input"],At.TextArea),dt={...Ce(L,{attr:!0,aria:!0,data:!0}),ref:z},$e=()=>{q&&y&&!S&&y(q)},ut=()=>{Z("")},ve=n.useRef(!1),mt=()=>{ve.current=!0},pt=()=>{ve.current=!1},ft=F=>{const G=F.key==="Enter"&&!ve.current;switch(b){case"enter":G&&!F.shiftKey&&(F.preventDefault(),$e());break;case"shiftEnter":G&&F.shiftKey&&(F.preventDefault(),$e());break}B?.(F)},gt=F=>{const G=F.clipboardData?.files;G?.length&&p&&(p(G[0],G),F.preventDefault()),R?.(F)},ht=F=>{F.target!==A.current?.querySelector(`.${X}`)&&F.preventDefault(),z.current?.focus()};let re=n.createElement(ie,{className:`${U}-presets`},x&&n.createElement(nt,null),S?n.createElement(et,null):n.createElement(tt,null));typeof M=="function"?re=M(re,{components:Fe}):(M||M===!1)&&(re=M);const yt={prefixCls:O,onSend:$e,onSendDisabled:!q,onClear:ut,onClearDisabled:!q,onCancel:m,onCancelDisabled:!S,onSpeech:()=>Ie(!1),onSpeechDisabled:!it,speechRecording:lt,disabled:$},Le=typeof I=="function"?I({components:Fe}):I||null;return j(n.createElement("div",{ref:A,className:_,style:{...T.style,...l}},D&&n.createElement(Qe.Provider,{value:{prefixCls:N}},D),n.createElement(xe.Provider,{value:yt},n.createElement("div",{className:`${N}-content`,onMouseDown:ht},C&&n.createElement("div",{className:v(`${N}-prefix`,T.classNames.prefix,s.prefix),style:{...T.styles.prefix,...r.prefix}},C),n.createElement(ct,W({},dt,{disabled:$,style:{...T.styles.input,...r.input},className:v(X,T.classNames.input,s.input),autoSize:E,value:q,onChange:F=>{Z(F.target.value,F),Ie(!0)},onPressEnter:ft,onCompositionStart:mt,onCompositionEnd:pt,onKeyDown:h,onPaste:gt,variant:"borderless",readOnly:u})),re&&n.createElement("div",{className:v(U,T.classNames.actions,s.actions),style:{...T.styles.actions,...r.actions}},re)),Le&&n.createElement("div",{className:v(`${N}-footer`,T.classNames.footer,s.footer),style:{...T.styles.footer,...r.footer}},Le))))}),_n=Fn;_n.Header=En;function pe(e){return typeof e=="string"}const Wn=(e,t,o,r)=>{const s=f.useRef(""),[a,i]=f.useState(1),l=t&&pe(e);return zt(()=>{!l&&pe(e)?i(e.length):pe(e)&&pe(s.current)&&e.indexOf(s.current)!==0&&i(1),s.current=e},[e]),f.useEffect(()=>{if(l&&a<e.length){const d=setTimeout(()=>{i(u=>u+o)},r);return()=>{clearTimeout(d)}}},[a,t,e]),[l?e.slice(0,a):e,l&&a<e.length]};function qn(e){return f.useMemo(()=>{if(!e)return[!1,0,0,null];let t={step:1,interval:50,suffix:null};return typeof e=="object"&&(t={...t,...e}),[!0,t.step,t.interval,t.suffix]},[e])}const Un=({prefixCls:e})=>n.createElement("span",{className:`${e}-dot`},n.createElement("i",{className:`${e}-dot-item`,key:"item-1"}),n.createElement("i",{className:`${e}-dot-item`,key:"item-2"}),n.createElement("i",{className:`${e}-dot-item`,key:"item-3"})),On=e=>{const{componentCls:t,paddingSM:o,padding:r}=e;return{[t]:{[`${t}-content`]:{"&-filled,&-outlined,&-shadow":{padding:`${J(o)} ${J(r)}`,borderRadius:e.borderRadiusLG},"&-filled":{backgroundColor:e.colorFillContent},"&-outlined":{border:`1px solid ${e.colorBorderSecondary}`},"&-shadow":{boxShadow:e.boxShadowTertiary}}}}},jn=e=>{const{componentCls:t,fontSize:o,lineHeight:r,paddingSM:s,padding:a,calc:i}=e,l=i(o).mul(r).div(2).add(s).equal(),c=`${t}-content`;return{[t]:{[c]:{"&-round":{borderRadius:{_skip_check_:!0,value:l},paddingInline:i(a).mul(1.25).equal()}},[`&-start ${c}-corner`]:{borderStartStartRadius:e.borderRadiusXS},[`&-end ${c}-corner`]:{borderStartEndRadius:e.borderRadiusXS}}}},kn=e=>{const{componentCls:t,padding:o}=e;return{[`${t}-list`]:{display:"flex",flexDirection:"column",gap:o,overflowY:"auto","&::-webkit-scrollbar":{width:8,backgroundColor:"transparent"},"&::-webkit-scrollbar-thumb":{backgroundColor:e.colorTextTertiary,borderRadius:e.borderRadiusSM},"&":{scrollbarWidth:"thin",scrollbarColor:`${e.colorTextTertiary} transparent`}}}},Vn=new ke("loadingMove",{"0%":{transform:"translateY(0)"},"10%":{transform:"translateY(4px)"},"20%":{transform:"translateY(0)"},"30%":{transform:"translateY(-4px)"},"40%":{transform:"translateY(0)"}}),Gn=new ke("cursorBlink",{"0%":{opacity:1},"50%":{opacity:0},"100%":{opacity:1}}),Kn=e=>{const{componentCls:t,fontSize:o,lineHeight:r,paddingSM:s,colorText:a,calc:i}=e;return{[t]:{display:"flex",columnGap:s,[`&${t}-end`]:{justifyContent:"end",flexDirection:"row-reverse",[`& ${t}-content-wrapper`]:{alignItems:"flex-end"}},[`&${t}-rtl`]:{direction:"rtl"},[`&${t}-typing ${t}-content:last-child::after`]:{content:'"|"',fontWeight:900,userSelect:"none",opacity:1,marginInlineStart:"0.1em",animationName:Gn,animationDuration:"0.8s",animationIterationCount:"infinite",animationTimingFunction:"linear"},[`& ${t}-avatar`]:{display:"inline-flex",justifyContent:"center",alignSelf:"flex-start"},[`& ${t}-header, & ${t}-footer`]:{fontSize:o,lineHeight:r,color:e.colorText},[`& ${t}-header`]:{marginBottom:e.paddingXXS},[`& ${t}-footer`]:{marginTop:s},[`& ${t}-content-wrapper`]:{flex:"auto",display:"flex",flexDirection:"column",alignItems:"flex-start",minWidth:0,maxWidth:"100%"},[`& ${t}-content`]:{position:"relative",boxSizing:"border-box",minWidth:0,maxWidth:"100%",color:a,fontSize:e.fontSize,lineHeight:e.lineHeight,minHeight:i(s).mul(2).add(i(r).mul(o)).equal(),wordBreak:"break-word",[`& ${t}-dot`]:{position:"relative",height:"100%",display:"flex",alignItems:"center",columnGap:e.marginXS,padding:`0 ${J(e.paddingXXS)}`,"&-item":{backgroundColor:e.colorPrimary,borderRadius:"100%",width:4,height:4,animationName:Vn,animationDuration:"2s",animationIterationCount:"infinite",animationTimingFunction:"linear","&:nth-child(1)":{animationDelay:"0s"},"&:nth-child(2)":{animationDelay:"0.2s"},"&:nth-child(3)":{animationDelay:"0.4s"}}}}}}},Yn=()=>({}),rt=te("Bubble",e=>{const t=Q(e,{});return[Kn(t),kn(t),On(t),jn(t)]},Yn),ot=n.createContext({}),Zn=(e,t)=>{const{prefixCls:o,className:r,rootClassName:s,style:a,classNames:i={},styles:l={},avatar:c,placement:d="start",loading:u=!1,loadingRender:b,typing:y,content:S="",messageRender:w,variant:m="filled",shape:g,onTypingComplete:M,header:B,footer:h,_key:$,...x}=e,{onUpdate:C}=n.useContext(ot),I=n.useRef(null);n.useImperativeHandle(t,()=>({nativeElement:I.current}));const{direction:D,getPrefixCls:R}=k(),p=R("bubble",o),E=ee("bubble"),[L,P,H,N]=qn(y),[A,z]=Wn(S,L,P,H);n.useEffect(()=>{C?.()},[A]);const T=n.useRef(!1);n.useEffect(()=>{!z&&!u?T.current||(T.current=!0,M?.()):T.current=!1},[z,u]);const[X,j,V]=rt(p),Y=v(p,s,E.className,r,j,V,`${p}-${d}`,{[`${p}-rtl`]:D==="rtl",[`${p}-typing`]:z&&!u&&!w&&!N}),_=n.useMemo(()=>n.isValidElement(c)?c:n.createElement(Ft,c),[c]),O=n.useMemo(()=>w?w(A):A,[A,w]),U=Z=>typeof Z=="function"?Z(A,{key:$}):Z;let q;u?q=b?b():n.createElement(Un,{prefixCls:p}):q=n.createElement(n.Fragment,null,O,z&&N);let ne=n.createElement("div",{style:{...E.styles.content,...l.content},className:v(`${p}-content`,`${p}-content-${m}`,g&&`${p}-content-${g}`,E.classNames.content,i.content)},q);return(B||h)&&(ne=n.createElement("div",{className:`${p}-content-wrapper`},B&&n.createElement("div",{className:v(`${p}-header`,E.classNames.header,i.header),style:{...E.styles.header,...l.header}},U(B)),ne,h&&n.createElement("div",{className:v(`${p}-footer`,E.classNames.footer,i.footer),style:{...E.styles.footer,...l.footer}},U(h)))),X(n.createElement("div",W({style:{...E.style,...a},className:Y},x,{ref:I}),c&&n.createElement("div",{style:{...E.styles.avatar,...l.avatar},className:v(`${p}-avatar`,E.classNames.avatar,i.avatar)},_),ne))},st=n.forwardRef(Zn);function Jn(e,t){const o=f.useCallback((r,s)=>typeof t=="function"?t(r,s):t?t[r.role]||{}:{},[t]);return f.useMemo(()=>(e||[]).map((r,s)=>{const a=r.key??`preset_${s}`;return{...o(r,s),...r,key:a}}),[e,o])}const Qn=({_key:e,...t},o)=>f.createElement(st,W({},t,{_key:e,ref:r=>{r?o.current[e]=r:delete o.current?.[e]}})),er=f.memo(f.forwardRef(Qn)),tr=1,nr=(e,t)=>{const{prefixCls:o,rootClassName:r,className:s,items:a,autoScroll:i=!0,roles:l,onScroll:c,...d}=e,u=Ce(d,{attr:!0,aria:!0}),b=f.useRef(null),y=f.useRef({}),{getPrefixCls:S}=k(),w=S("bubble",o),m=`${w}-list`,[g,M,B]=rt(w),[h,$]=f.useState(!1);f.useEffect(()=>($(!0),()=>{$(!1)}),[]);const x=Jn(a,l),[C,I]=f.useState(!0),[D,R]=f.useState(0),p=P=>{const H=P.target;I(H.scrollHeight-Math.abs(H.scrollTop)-H.clientHeight<=tr),c?.(P)};f.useEffect(()=>{i&&b.current&&C&&b.current.scrollTo({top:b.current.scrollHeight})},[D]),f.useEffect(()=>{if(i){const P=x[x.length-2]?.key,H=y.current[P];if(H){const{nativeElement:N}=H,{top:A,bottom:z}=N.getBoundingClientRect(),{top:T,bottom:X}=b.current.getBoundingClientRect();A<X&&z>T&&(R(V=>V+1),I(!0))}}},[x.length]),f.useImperativeHandle(t,()=>({nativeElement:b.current,scrollTo:({key:P,offset:H,behavior:N="smooth",block:A})=>{if(typeof H=="number")b.current.scrollTo({top:H,behavior:N});else if(P!==void 0){const z=y.current[P];if(z){const T=x.findIndex(X=>X.key===P);I(T===x.length-1),z.nativeElement.scrollIntoView({behavior:N,block:A})}}}}));const E=le(()=>{i&&R(P=>P+1)}),L=f.useMemo(()=>({onUpdate:E}),[]);return g(f.createElement(ot.Provider,{value:L},f.createElement("div",W({},u,{className:v(m,r,s,M,B,{[`${m}-reach-end`]:C}),ref:b,onScroll:p}),x.map(({key:P,...H})=>f.createElement(er,W({},H,{key:P,_key:P,ref:y,typing:h?H.typing:!1}))))))},rr=f.forwardRef(nr);st.List=rr;const at=n.createContext(null),_e=({children:e})=>{const{prefixCls:t}=n.useContext(at);return n.createElement("div",{className:v(`${t}-group-title`)},e&&n.createElement(K.Text,null,e))},We=e=>{e.stopPropagation()},or=e=>{const{prefixCls:t,info:o,className:r,direction:s,onClick:a,active:i,menu:l,...c}=e,d=Ce(c,{aria:!0,data:!0,attr:!0}),{disabled:u}=o,b=v(r,`${t}-item`,{[`${t}-item-active`]:i&&!u},{[`${t}-item-disabled`]:u}),y=()=>{!u&&a&&a(o)},{trigger:S,...w}=l||{},m=w?.getPopupContainer,g=M=>{const B=n.createElement(Wt,{onClick:We,className:`${t}-menu-icon`});return S?typeof S=="function"?S(M,{originNode:B}):S:B};return n.createElement("li",W({title:typeof o.label=="object"?void 0:`${o.label}`},d,{className:b,onClick:y}),o.icon&&n.createElement("div",{className:`${t}-icon`},o.icon),n.createElement(K.Text,{className:`${t}-label`},o.label),!u&&l&&n.createElement("div",{onClick:We},n.createElement(_t,{menu:w,placement:s==="rtl"?"bottomLeft":"bottomRight",trigger:["click"],disabled:u,getPopupContainer:m},g(o))))},we="__ungrouped",sr=(e,t=[])=>{const[o,r,s]=n.useMemo(()=>{if(!e)return[!1,void 0,void 0];let a={sort:void 0,title:void 0};return typeof e=="object"&&(a={...a,...e}),[!0,a.sort,a.title]},[e]);return n.useMemo(()=>{if(!o)return[[{name:we,data:t,title:void 0}],o];const a=t.reduce((c,d)=>{const u=d.group||we;return c[u]||(c[u]=[]),c[u].push(d),c},{});return[(r?Object.keys(a).sort(r):Object.keys(a)).map(c=>({name:c===we?void 0:c,title:s,data:a[c]})),o]},[t,e])},ar=e=>{const{componentCls:t}=e;return{[t]:{display:"flex",flexDirection:"column",gap:e.paddingXXS,overflowY:"auto",padding:e.paddingSM,margin:0,listStyle:"none","ul, ol":{margin:0,padding:0,listStyle:"none"},[`&${t}-rtl`]:{direction:"rtl"},[`& ${t}-list`]:{display:"flex",gap:e.paddingXXS,flexDirection:"column",[`& ${t}-item`]:{paddingInlineStart:e.paddingXL},[`& ${t}-label`]:{color:e.colorTextDescription,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},[`& ${t}-item`]:{display:"flex",height:e.controlHeightLG,minHeight:e.controlHeightLG,gap:e.paddingXS,padding:`0 ${J(e.paddingXS)}`,alignItems:"center",borderRadius:e.borderRadiusLG,cursor:"pointer",transition:`all ${e.motionDurationMid} ${e.motionEaseInOut}`,"&:hover":{backgroundColor:e.colorBgTextHover},"&-active":{backgroundColor:e.colorBgTextHover,[`& ${t}-label, ${t}-menu-icon`]:{color:e.colorText}},"&-disabled":{cursor:"not-allowed",[`& ${t}-label`]:{color:e.colorTextDisabled}},"&:hover, &-active":{[`& ${t}-menu-icon`]:{opacity:.6}},[`${t}-menu-icon:hover`]:{opacity:1}},[`& ${t}-label`]:{flex:1,color:e.colorText,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},[`& ${t}-menu-icon`]:{opacity:0,fontSize:e.fontSizeXL},[`& ${t}-group-title`]:{display:"flex",alignItems:"center",height:e.controlHeightLG,minHeight:e.controlHeightLG,padding:`0 ${J(e.paddingXS)}`}}}},ir=()=>({}),lr=te("Conversations",e=>{const t=Q(e,{});return ar(t)},ir),Mr=e=>{const{prefixCls:t,rootClassName:o,items:r,activeKey:s,defaultActiveKey:a,onActiveChange:i,menu:l,styles:c={},classNames:d={},groupable:u,className:b,style:y,...S}=e,w=Ce(S,{attr:!0,aria:!0,data:!0}),[m,g]=be(a,{value:s}),[M,B]=sr(u,r),{getPrefixCls:h,direction:$}=k(),x=h("conversations",t),C=ee("conversations"),[I,D,R]=lr(x),p=v(x,C.className,b,o,D,R,{[`${x}-rtl`]:$==="rtl"}),E=L=>{g(L.key),i&&i(L.key)};return I(n.createElement("ul",W({},w,{style:{...C.style,...y},className:p}),M.map((L,P)=>{const H=L.data.map((N,A)=>{const{label:z,disabled:T,icon:X,...j}=N;return n.createElement(or,W({},j,{key:N.key||`key-${A}`,info:N,prefixCls:x,direction:$,className:v(d.item,C.classNames.item,N.className),style:{...C.styles.item,...c.item,...N.style},menu:typeof l=="function"?l(N):l,active:m===N.key,onClick:E}))});return B?n.createElement("li",{key:L.name||`key-${P}`},n.createElement(at.Provider,{value:{prefixCls:x}},L.title?.(L.name,{components:{GroupTitle:_e}})||n.createElement(_e,{key:L.name},L.name)),n.createElement("ul",{className:`${x}-list`},H)):H})))},cr=e=>{const{componentCls:t}=e;return{[t]:{"&, & *":{boxSizing:"border-box"},maxWidth:"100%",[`&${t}-rtl`]:{direction:"rtl"},[`& ${t}-title`]:{marginBlockStart:0,fontWeight:"normal",color:e.colorTextTertiary},[`& ${t}-list`]:{display:"flex",gap:e.paddingSM,overflowX:"auto",scrollbarWidth:"none","-ms-overflow-style":"none","&::-webkit-scrollbar":{display:"none"},listStyle:"none",paddingInlineStart:0,marginBlock:0,alignItems:"stretch","&-wrap":{flexWrap:"wrap"},"&-vertical":{flexDirection:"column",alignItems:"flex-start"}},[`${t}-item`]:{flex:"none",display:"flex",gap:e.paddingXS,height:"auto",paddingBlock:e.paddingSM,paddingInline:e.padding,alignItems:"flex-start",justifyContent:"flex-start",background:e.colorBgContainer,borderRadius:e.borderRadiusLG,transition:["border","background"].map(o=>`${o} ${e.motionDurationSlow}`).join(","),border:`${J(e.lineWidth)} ${e.lineType} ${e.colorBorderSecondary}`,[`&:not(${t}-item-has-nest)`]:{"&:hover":{cursor:"pointer",background:e.colorFillTertiary},"&:active":{background:e.colorFill}},[`${t}-content`]:{flex:"auto",minWidth:0,display:"flex",gap:e.paddingXXS,flexDirection:"column",alignItems:"flex-start"},[`${t}-icon, ${t}-label, ${t}-desc`]:{margin:0,padding:0,fontSize:e.fontSize,lineHeight:e.lineHeight,textAlign:"start",whiteSpace:"normal"},[`${t}-label`]:{color:e.colorTextHeading,fontWeight:500},[`${t}-label + ${t}-desc`]:{color:e.colorTextTertiary},[`&${t}-item-disabled`]:{pointerEvents:"none",background:e.colorBgContainerDisabled,[`${t}-label, ${t}-desc`]:{color:e.colorTextTertiary}}}}}},dr=e=>{const{componentCls:t}=e;return{[t]:{[`${t}-item-has-nest`]:{[`> ${t}-content`]:{[`> ${t}-label`]:{fontSize:e.fontSizeLG,lineHeight:e.lineHeightLG}}},[`&${t}-nested`]:{marginTop:e.paddingXS,alignSelf:"stretch",[`${t}-list`]:{alignItems:"stretch"},[`${t}-item`]:{border:0,background:e.colorFillQuaternary}}}}},ur=()=>({}),mr=te("Prompts",e=>{const t=Q(e,{});return[cr(t),dr(t)]},ur),pr=e=>{const{prefixCls:t,title:o,className:r,items:s,onItemClick:a,vertical:i,wrap:l,rootClassName:c,styles:d={},classNames:u={},style:b,...y}=e,{getPrefixCls:S,direction:w}=k(),m=S("prompts",t),g=ee("prompts"),[M,B,h]=mr(m),$=v(m,g.className,r,c,B,h,{[`${m}-rtl`]:w==="rtl"}),x=v(`${m}-list`,g.classNames.list,u.list,{[`${m}-list-wrap`]:l},{[`${m}-list-vertical`]:i});return M(n.createElement("div",W({},y,{className:$,style:{...b,...g.style}}),o&&n.createElement(K.Title,{level:5,className:v(`${m}-title`,g.classNames.title,u.title),style:{...g.styles.title,...d.title}},o),n.createElement("div",{className:x,style:{...g.styles.list,...d.list}},s?.map((C,I)=>{const D=C.children&&C.children.length>0;return n.createElement("div",{key:C.key||`key_${I}`,style:{...g.styles.item,...d.item},className:v(`${m}-item`,g.classNames.item,u.item,{[`${m}-item-disabled`]:C.disabled,[`${m}-item-has-nest`]:D}),onClick:()=>{!D&&a&&a({data:C})}},C.icon&&n.createElement("div",{className:`${m}-icon`},C.icon),n.createElement("div",{className:v(`${m}-content`,g.classNames.itemContent,u.itemContent),style:{...g.styles.itemContent,...d.itemContent}},C.label&&n.createElement("h6",{className:`${m}-label`},C.label),C.description&&n.createElement("p",{className:`${m}-desc`},C.description),D&&n.createElement(pr,{className:`${m}-nested`,items:C.children,vertical:!0,onItemClick:a,classNames:{list:u.subList,item:u.subItem},styles:{list:d.subList,item:d.subItem}})))}))))},fr=e=>{const{componentCls:t,calc:o}=e,r=o(e.fontSizeHeading3).mul(e.lineHeightHeading3).equal(),s=o(e.fontSize).mul(e.lineHeight).equal();return{[t]:{gap:e.padding,[`${t}-icon`]:{height:o(r).add(s).add(e.paddingXXS).equal(),display:"flex",img:{height:"100%"}},[`${t}-content-wrapper`]:{gap:e.paddingXS,flex:"auto",minWidth:0,[`${t}-title-wrapper`]:{gap:e.paddingXS},[`${t}-title`]:{margin:0},[`${t}-extra`]:{marginInlineStart:"auto"}}}}},gr=e=>{const{componentCls:t}=e;return{[t]:{"&-filled":{paddingInline:e.padding,paddingBlock:e.paddingSM,background:e.colorFillContent,borderRadius:e.borderRadiusLG},"&-borderless":{[`${t}-title`]:{fontSize:e.fontSizeHeading3,lineHeight:e.lineHeightHeading3}}}}},hr=()=>({}),yr=te("Welcome",e=>{const t=Q(e,{});return[fr(t),gr(t)]},hr);function br(e,t){const{prefixCls:o,rootClassName:r,className:s,style:a,variant:i="filled",classNames:l={},styles:c={},icon:d,title:u,description:b,extra:y}=e,{direction:S,getPrefixCls:w}=k(),m=w("welcome",o),g=ee("welcome"),[M,B,h]=yr(m),$=n.useMemo(()=>{if(!d)return null;let I=d;return typeof d=="string"&&d.startsWith("http")&&(I=n.createElement("img",{src:d,alt:"icon"})),n.createElement("div",{className:v(`${m}-icon`,g.classNames.icon,l.icon),style:c.icon},I)},[d]),x=n.useMemo(()=>u?n.createElement(K.Title,{level:4,className:v(`${m}-title`,g.classNames.title,l.title),style:c.title},u):null,[u]),C=n.useMemo(()=>y?n.createElement("div",{className:v(`${m}-extra`,g.classNames.extra,l.extra),style:c.extra},y):null,[y]);return M(n.createElement(ie,{ref:t,className:v(m,g.className,s,r,B,h,`${m}-${i}`,{[`${m}-rtl`]:S==="rtl"}),style:a},$,n.createElement(ie,{vertical:!0,className:`${m}-content-wrapper`},y?n.createElement(ie,{align:"flex-start",className:`${m}-title-wrapper`},x,C):x,b&&n.createElement(K.Text,{className:v(`${m}-description`,g.classNames.description,l.description),style:c.description},b))))}const Pr=n.forwardRef(br);function Cr(e){const[,t]=n.useState(0),o=n.useRef(typeof e=="function"?e():e),r=n.useCallback(a=>{o.current=typeof a=="function"?a(o.current):a,t(i=>i+1)},[]),s=n.useCallback(()=>o.current,[]);return[o.current,r,s]}function xr(e){return Array.isArray(e)?e:[e]}function Hr(e){const{defaultMessages:t,agent:o,requestFallback:r,requestPlaceholder:s,parser:a,transformMessage:i,transformStream:l,resolveAbortController:c}=e,d=n.useRef(0),[u,b,y]=Cr(()=>(t||[]).map((h,$)=>({id:`default_${$}`,status:"local",...h}))),S=(h,$)=>{const x={id:`msg_${d.current}`,message:h,status:$};return d.current+=1,x},w=n.useMemo(()=>{const h=[];return u.forEach($=>{const x=a?a($.message):$.message,C=xr(x);C.forEach((I,D)=>{let R=$.id;C.length>1&&(R=`${R}_${D}`),h.push({id:R,message:I,status:$.status})})}),h},[u]),m=h=>h.filter($=>$.status!=="loading"&&$.status!=="error").map($=>$.message),g=()=>m(y()),M=h=>{const{chunk:$,chunks:x,originMessage:C}=h;if(typeof i=="function")return i(h);if($)return $;if(Array.isArray(x)){const I=x?.length>0?x?.[x?.length-1]:void 0;return C||I}return x};return{onRequest:le(h=>{if(!o)throw new Error("The agent parameter is required when using the onRequest method in an agent generated by useXAgent.");let $=null,x,C={};if(h&&typeof h=="object"&&"message"in h){const{message:R,...p}=h;x=R,C=p}else x=h;b(R=>{let p=[...R,S(x,"local")];if(s){let E;typeof s=="function"?E=s(x,{messages:m(p)}):E=s;const L=S(E,"loading");$=L.id,p=[...p,L]}return p});let I=null;const D=(R,p,E)=>{let L=y().find(P=>P.id===I);if(L)b(P=>P.map(H=>{if(H.id===I){const N=M({originMessage:H.message,chunk:p,chunks:E,status:R});return{...H,message:N,status:R}}return H}));else{const P=M({chunk:p,status:R,chunks:E});L=S(P,R),b(H=>[...H.filter(A=>A.id!==$),L]),I=L.id}return L};o.request({message:x,messages:g(),...C},{onUpdate:R=>{D("loading",R,[])},onSuccess:R=>{D("success",void 0,R)},onError:async R=>{if(r){let p;typeof r=="function"?p=await r(x,{error:R,messages:g()}):p=r,b(E=>[...E.filter(L=>L.id!==$&&L.id!==I),S(p,"error")])}else b(p=>p.filter(E=>E.id!==$&&E.id!==I))},onStream:R=>{c?.(R)}},l)}),messages:u,parsedMessages:w,setMessages:b}}const Sr=`

`,$r=`
`,qe=":",Ne=e=>(e??"").trim()!=="";function vr(){let e="";return new TransformStream({transform(t,o){e+=t;const r=e.split(Sr);r.slice(0,-1).forEach(s=>{Ne(s)&&o.enqueue(s)}),e=r[r.length-1]},flush(t){Ne(e)&&t.enqueue(e)}})}function Er(){return new TransformStream({transform(e,t){const r=e.split($r).reduce((s,a)=>{const i=a.indexOf(qe);if(i===-1)throw new Error(`The key-value separator "${qe}" is not found in the sse line chunk!`);const l=a.slice(0,i);if(!Ne(l))return s;const c=a.slice(i+1);return{...s,[l]:c}},{});Object.keys(r).length!==0&&t.enqueue(r)}})}function Ue(e){const{readableStream:t,transformStream:o}=e;if(!(t instanceof ReadableStream))throw new Error("The options.readableStream must be an instance of ReadableStream.");const r=new TextDecoderStream,s=o?t.pipeThrough(r).pipeThrough(o):t.pipeThrough(r).pipeThrough(vr()).pipeThrough(Er());return s[Symbol.asyncIterator]=async function*(){const a=this.getReader();for(;;){const{done:i,value:l}=await a.read();if(i)break;l&&(yield l)}},s}const wr=async(e,t={})=>{const{fetch:o=globalThis.fetch,middlewares:r={},...s}=t;if(typeof o!="function")throw new Error("The options.fetch must be a typeof fetch function!");let a=[e,s];typeof r.onRequest=="function"&&(a=await r.onRequest(...a));let i=await o(...a);if(typeof r.onResponse=="function"){const l=await r.onResponse(i);if(!(l instanceof Response))throw new Error("The options.onResponse must return a Response instance!");i=l}if(!i.ok)throw new Error(`Fetch failed with status ${i.status}`);if(!i.body)throw new Error("The response body is empty.");return i};class Te{baseURL;model;defaultHeaders;customOptions;constructor(t){const{baseURL:o,model:r,dangerouslyApiKey:s,...a}=t;this.baseURL=t.baseURL,this.model=t.model,this.defaultHeaders={"Content-Type":"application/json",...t.dangerouslyApiKey&&{Authorization:t.dangerouslyApiKey}},this.customOptions=a}static init(t){if(!t.baseURL||typeof t.baseURL!="string")throw new Error("The baseURL is not valid!");return new Te(t)}create=async(t,o,r)=>{const s=new AbortController,a={method:"POST",body:JSON.stringify({model:this.model,...t}),headers:this.defaultHeaders,signal:s.signal};o?.onStream?.(s);try{const i=await wr(this.baseURL,{fetch:this.customOptions.fetch,...a});if(r){await this.customResponseHandler(i,o,r);return}const l=i.headers.get("content-type")||"";switch(l.split(";")[0].trim()){case"text/event-stream":await this.sseResponseHandler(i,o);break;case"application/json":await this.jsonResponseHandler(i,o);break;default:throw new Error(`The response content-type: ${l} is not support!`)}}catch(i){const l=i instanceof Error?i:new Error("Unknown error!");throw o?.onError?.(l),l}};customResponseHandler=async(t,o,r)=>{const s=[];for await(const a of Ue({readableStream:t.body,transformStream:r}))s.push(a),o?.onUpdate?.(a);o?.onSuccess?.(s)};sseResponseHandler=async(t,o)=>{const r=[],s=Ue({readableStream:t.body});for await(const a of s)r.push(a),o?.onUpdate?.(a);o?.onSuccess?.(r)};jsonResponseHandler=async(t,o)=>{const r=await t.json();o?.onUpdate?.(r),o?.onSuccess?.([r])}}const Rr=Te.init;let Oe=0;class Nr{config;requestingMap={};constructor(t){this.config=t}finishRequest(t){delete this.requestingMap[t]}request=(t,o,r)=>{const{request:s}=this.config,{onUpdate:a,onSuccess:i,onError:l,onStream:c}=o,d=Oe;Oe+=1,this.requestingMap[d]=!0,s?.(t,{onStream:u=>{this.requestingMap[d]&&c?.(u)},onUpdate:u=>{this.requestingMap[d]&&a(u)},onSuccess:u=>{this.requestingMap[d]&&(i(u),this.finishRequest(d))},onError:u=>{this.requestingMap[d]&&(l(u),this.finishRequest(d))}},r)};isRequesting(){return Object.keys(this.requestingMap).length>0}}function Dr(e){const{request:t,...o}=e;return n.useMemo(()=>[new Nr({request:t||Rr({baseURL:o.baseURL,model:o.model,dangerouslyApiKey:o.dangerouslyApiKey}).create,...o})],[e?.baseURL,e?.dangerouslyApiKey,e?.model])}export{Mr as C,st as F,pr as P,_n as S,Hr as a,Pr as b,$n as c,Dr as u};
